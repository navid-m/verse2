<div class="border-l-2 border-gray-200 dark:border-gray-600 pl-4 {% if is_reply %}ml-4{% endif %}" data-comment-id="{{ comment.ID }}">
    <div class="flex items-start space-x-3">
        <div class="flex-shrink-0">
            <div class="{% if is_reply %}w-6 h-6{% else %}w-8 h-8{% endif %} bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center">
                {% if is_reply %}<i class="fas fa-reply text-gray-600 dark:text-gray-400 text-xs"></i>{% else %}<i class="fas fa-user text-gray-600 dark:text-gray-400 text-xs"></i>{% endif %}
            </div>
        </div>
        <div class="flex-1 min-w-0">
            <div class="flex items-center space-x-2 mb-1">
                <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ comment.Username }}</span>
                <span class="text-xs text-gray-500 dark:text-gray-400">{{ comment.CreatedAt|date:"M j, Y at P" }}</span>
            </div>
            <div class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">
                {{ comment.Content|safe }}
            </div>
            <div class="flex items-center space-x-2 mt-2">
                <button class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-500 reply-btn" data-comment-id="{{ comment.ID }}" data-post-id="{{ comment.ItemID }}">
                    <i class="fas fa-reply mr-1"></i>Reply
                </button>
                {% if is_owner %}
                <button class="text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 edit-comment-btn" data-comment-id="{{ comment.ID }}">
                    <i class="fas fa-edit mr-1"></i>Edit
                </button>
                <button class="text-xs text-red-500 hover:text-red-700 delete-comment-btn" data-comment-id="{{ comment.ID }}">
                    <i class="fas fa-trash mr-1"></i>Delete
                </button>
                {% endif %}
            </div>

            <!-- Reply Form (hidden by default) -->
            <div class="reply-form mt-3 hidden" data-comment-id="{{ comment.ID }}">
                <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0">
                        <div class="w-6 h-6 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center">
                            <i class="fas fa-reply text-gray-600 dark:text-gray-400 text-xs"></i>
                        </div>
                    </div>
                    <div class="flex-1">
                        <textarea class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 text-sm resize-y" rows="2" placeholder="Write a reply..." data-reply-content="{{ comment.ID }}"></textarea>
                        <div class="flex justify-end space-x-2 mt-2">
                            <button class="px-3 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 cancel-reply-btn" data-comment-id="{{ comment.ID }}">Cancel</button>
                            <button class="px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 submit-reply-btn" data-comment-id="{{ comment.ID }}" data-parent-id="{{ comment.ID }}" data-post-id="{{ comment.ItemID }}">Reply</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    {% if comment.Replies %}
    <div class="replies-container mt-3 space-y-2" data-replies-container="{{ comment.ID }}">
        <!-- Replies will be rendered by JavaScript or the macro in post.html -->
    </div>
    {% endif %}
</div>